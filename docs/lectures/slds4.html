<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>yakagika - 特別講義DS Ch4 ライブラリの利用</title>

    <!-- Stylesheets. -->
    <link rel="stylesheet" type="text/css" href="../style.css?v=0">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&display=swap" rel="stylesheet">
    <!-- RSS. -->
    <link rel="alternate" type="application/rss+xml" title="yakagika" href="https://yakagika.github.io/rss.xml">

    <!-- Metadata. -->

    <meta name="keywords" content="yakagika Haskell ExchangeAlgebra">
    <meta name="description" content="Personal home page and blog of yakagika.">

    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css" integrity="sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js" integrity="sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
    

    
      <meta property="og:description" content="資料" />
    
  </head>

  <body>

    <!-- ハンバーガーメニューのボタン（小画面時に表示） -->
     <!-- ヘッダーを上部に固定し、その中にハンバーガーを配置 -->
    <header class="site-header">
      <div class="site-title">
        <a href="../">
          <img src="../favicon.ico" alt="Home" style="width: 32px; height: 32px;">
        </a>
      </div>
      <div class="hamburger" onclick="toggleMenu()">☰</div>
    </header>

    <!-- ナビゲーションに drawer-menu クラスを付与 -->
    <div id="navigation" class="drawer-menu">
      <h1>Contents</h1>
      <a href="../">Home</a>
      <a href="../posts.html">Blog</a>
      <a href="../lectures.html">Lecture</a>
      <a href="../research.html">Research</a>
      <a href="../contact.html">Contact</a>
      <!-- <a href="/cv.html">CV</a> -->

      <h1>Links</h1>
      <a href="http://github.com/yakagika" target="_blank" rel="noopener">GitHub</a>
      <a href="https://researchmap.jp/k-akagi" target="_blank" rel="noopener">researchmap</a>

      
      <div id="lecture-toc">
        <h1>Index</h1>
        <!-- The TOC will be generated here by JavaScript -->
      </div>
      
      
    </div>

    <div id="content">
    <h1>特別講義DS Ch4 ライブラリの利用</h1>
<div class="soft">
    資料<br />
    Published on 2024-03-29 under the tag <a title="All pages tagged 'datascience'." href="../tags/datascience.html">datascience</a>, <a title="All pages tagged 'statistics'." href="../tags/statistics.html">statistics</a>, <a title="All pages tagged 'python'." href="../tags/python.html">python</a>
</div>

<!-- 前後の章へのナビゲーション -->
<div class="chapter-navigation">
    <nav>
        
            <a class="nav-link prev" href="slds2.html">← Previous Chapter</a>
        
        
            <a class="nav-link next" href="slds5.html">Next Chapter →</a>
        
    </nav>
</div>

<br>

<div class="toc"><div class="header">Table of Contents</div>
<ul>
<li><a href="#ライブラリの利用" id="toc-ライブラリの利用"><span class="toc-section-number">1</span> ライブラリの利用</a>
<ul>
<li><a href="#ライブラリとは" id="toc-ライブラリとは"><span class="toc-section-number">1.1</span> ライブラリとは</a></li>
<li><a href="#ライブラリを使ってみよう" id="toc-ライブラリを使ってみよう"><span class="toc-section-number">1.2</span> ライブラリを使ってみよう</a></li>
<li><a href="#なぜexcelではだめなのか" id="toc-なぜexcelではだめなのか"><span class="toc-section-number">1.3</span> なぜExcelではだめなのか</a></li>
</ul></li>
</ul>
</div>
<h2 data-number="1" id="ライブラリの利用"><span class="header-section-number">1</span> ライブラリの利用</h2>
<p>通常のPythonの学習では,基礎的な演算のあとにFor文やIF分を学びます.
しかし,この講義では通常のリストなどよりもむしろPandasとよばれるライブラリの機能を多用します.なので, 先にライブラリの利用法と,Pandasの利用法を学び,それらを事例としてFor文やIF文,関数などの基本的な構文を学習します.</p>
<h3 data-number="1.1" id="ライブラリとは"><span class="header-section-number">1.1</span> ライブラリとは</h3>
<p>第1回の講義で説明しましたが,プログラムをまとめて他の人がプログラム内で利用できるようにしたものをライブラリといいます. Pythonは,統計,データサイエンス関連のライブラリが充実しているために,利用者が多いということでしたね.</p>
<p>Pythonは様々なライブラリを呼び出して利用するための言語として利用されている側面が大きいです.なので, 目的に応じた様々なライブラリの使用法を知って初めてPythonの力を活用できます.</p>
<p>ライブラリのより細かい概念として, <strong>モジュール(Module)</strong>と<strong>Package(Package)</strong>があります.</p>
<div class="note">
<ul>
<li><code>Module</code>
<ul>
<li>他のプログラムに読み込む(<code>import</code>)することができるスクリプトファイル</li>
</ul></li>
<li><code>Package</code>
<ul>
<li>Moduleの名前空間をドットで構造化する手段</li>
</ul></li>
<li><code>Library</code>
<ul>
<li>用途に応じてPackageをまとめたもの</li>
</ul></li>
</ul>
</div>
<p><code>import</code>や名前空間の意味は,実際に使っていきながら見ていきましょう.</p>
<h3 data-number="1.2" id="ライブラリを使ってみよう"><span class="header-section-number">1.2</span> ライブラリを使ってみよう</h3>
<p>データサイエンスは,名前の通りデータを扱いデータから何かしらの示唆を得るための学問です.
データサイエンスにおける分析は概ね以下のように推移します.</p>
<figure>
<img src="../images/data-science-flow.png" alt="データ分析の流れ" />
<figcaption aria-hidden="true">データ分析の流れ</figcaption>
</figure>
<p>それぞれの段階の処理は,基本的には特定のライブラリを利用して行います. したがって,Pythonによるデータ分析の学習では,基本的にそれぞれの段階でのライブラリの利用法を学ぶことが中心になります.それぞれのライブラリの利用法はこれから順次扱いますが,ここでは,第1段階として,データの読み込みに関するライブラリ<code>pandas</code>を事例に一般的なライブラリの使用法を体験します.</p>
<p>何かしらのデータを分析するにはプログラムにデータを読み込む必要があります. Pythonにおいてデータの読み書き,整形,編集,生成などを支援する代表的なライブラリに <code>pandas</code>があります.</p>
<p>ライブラリを利用するためには,まずライブラリを皆さんのコンピュータにインストールする必要があります.
Pythonでライブラリをインストールするには<code>pip</code>を利用します. <code>pip</code>は,Pythonのインストール時に資料の指示に従ってチェックをつけていれば,既にインストールされているはずです.Shellに<code>pip --version</code>と入力してバージョンが表示されていれば,インストールされているので確認してみましょう(Macの人は<code>pip3 --version</code>).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> pip <span class="ex">--version</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> 24.0 from /Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/pip <span class="er">(</span><span class="ex">python</span> 3.10<span class="kw">)</span></span></code></pre></div>
<p><code>pip install</code>のあとに,インストールしたいライブラリ名を入力すると,ライブラリがインストールされます. 今回は <code>pandas</code>をインストールするので<code>pip install pandas</code>と入力しましょう. 文字が沢山表示されますが, 問題ありません. 画面が止まるまで待ちましょう.</p>
<p>pandasはデータを扱うためのライブラリなので利用するには,何かしらのデータが必要です. 本格的な利用はこのあとでしますが,取り敢えず利用確認用の簡単なデータを作成しましょう.</p>
<p>データはテーブルデータの形式を取ることが多く,pandasで読み込みや書き込みができるテーブルデータとして代表的な形式に<code>CSV(Comma  Separated Values)</code>があります.</p>
<div class="warn">
<p>最近はテーブルデータの高速な処理が可能な<a href="https://pola.rs"><code>Polars</code></a>なども流行っていますが,本資料ではPandasに限定します.</p>
<p>また,<code>JSON</code>や<code>XML</code>などの他のデータ形式に関しては扱いません.</p>
</div>
<p>CSVは,テキストファイルの一種で,その名の通りコンマ(<code>,</code>)で列を区切り,改行で行を区切ることでテーブルを表現します. 標準的なCSVでは最初の1行は,データではなく,各列の中身を表すタイトルとなっており<code>Header</code>と呼びます.2行目以下のデータ部分を<code>Body</code>と呼びます.</p>
<p>Excelを開いて1行目に<code>Weight</code>,<code>Height</code>,<code>BMI</code>と記入し,それぞれの列に以下のように数値を記入しましょう.<code>BMI</code>列は空欄で構いません.</p>
<figure>
<img src="../images/pandas-csv-sample.png" alt="csv sample" />
<figcaption aria-hidden="true">csv sample</figcaption>
</figure>
<p>このファイルを<code>UTF-8</code>の<code>CSV</code>として保存します. ファイル名は<code>body_data.csv</code>としましょう. Excelでは<code>ファイルの種類</code>で<code>CSV UTF-8 (コンマ区切り)(*.csv)</code>と選択することで保存できます.</p>
<figure>
<img src="../images/excel-file-type.png" alt="excel file type" />
<figcaption aria-hidden="true">excel file type</figcaption>
</figure>
<p>このファイルを作業ディレクトリの中に作った<code>data</code>という名前のフォルダに保存します.</p>
<p>試しに,<code>body_data.csv</code>をテキストエディタで開くと,中身がコンマと改行で表現されていることが分かります.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Height,Weight,BMI</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="dv">170</span>,<span class="dv">55</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="dv">180</span>,<span class="dv">72</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="dv">155</span>,<span class="dv">42</span>,</span></code></pre></div>
<p>Sublime Textでは <code>File</code>タブの<code>Save with Encoding</code>内の<code>UTF-8 with BOM</code>で保存し,拡張子を<code>.csv</code>にすることで保存できます.</p>
<p><img src="../images/Sublime-utf-8-bom.png" /></p>
<div class="warn">
<p><strong><code>BOM(Byte Order Mark)</code>について</strong></p>
<p>Unicode(UTF-8, UTF-16など)で文章が記載されていることを示す符号をBOMといい,ファイルの最初に記載されます.
これがついていることで,ソフトウェアでデータを読み込む際に自動的に,適切なエンコーディングが選択されます.
Excelの場合は<code>CSV UTF-8 (コンマ区切り)(*.csv)</code>でBOM付きのUTF-8として保存されますが,日本語環境ではBOMがついていないCSVファイルを<code>Shift-JIS</code>で開くため,外部ファイルの読み込みから適切なエンコーディングを選ばないと文字化けします.</p>
<p>この知識は後ほどpandasを利用したCSVの保存で再度扱います.</p>
</div>
<p>このファイルを読み込んで,pandasの機能をいくつか確認するためのスクリプトを書きます.
テキストエディタで<code>pandas_test.py</code>という空のファイルを作成し,以下のように記述しましょう.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data/body_data.csv'</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">'Weight'</span>].mean())</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">'Weight'</span>].median())</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'BMI'</span>] <span class="op">=</span> df[<span class="st">'Weight'</span>] <span class="op">/</span> (df[<span class="st">'Height'</span>]<span class="op">/</span><span class="dv">100</span>) <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code></pre></div>
<p>このプログラムを実行すると,以下のように表示されるはずです.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">❯</span> python3 pandas_test.py</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Height</span>  Weight  BMI</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="ex">0</span>     170      55  NaN</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span>     180      72  NaN</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="ex">2</span>     155      42  NaN</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="ex">56.333333333333336</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="ex">170.0</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Height</span>  Weight        BMI</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="ex">0</span>     170      55  19.031142</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span>     180      72  22.222222</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="ex">2</span>     155      42  17.481790</span></code></pre></div>
<p>このプログラムで何をしているのかを簡単に見ていきましょう.</p>
<p>まず一行目の<code>import pandas as pd</code>ですが,<code>import pandas</code>によってこのプログラム内で<code>pandas</code>を利用可能にしています. しかし,<code>pandas</code>と毎回かくのは面倒なので,省略形の<code>pd</code>という名前を定義しています. Pythonでは<code>import [利用したいライブラリ名] as [省略形]</code>
の形で,ライブラリのインポートと省略形の定義を同時に行えます. pandasは<code>df</code>と省略するのが一般的です.</p>
<p>続いて2行目の <code>df = pd.read_csv('data/body_data.csv')</code>で,先ほど作成した <code>data</code>フォルダにある<code>body_data.csv</code>というファイルを読み込んでいます. <code>df =</code>で読み込んだデータに<code>df</code>という名前をつけています.</p>
<p>3行目の<code>print(df)</code>で,読み込んでdfという名前をつかたデータを表示しています. REPLでは,変数を書くだけで表示されていましたが,スクリプトでは標準出力したいものは<code>print()</code>関数を適用する必要があります.</p>
<p>4,5行目は<code>Weight</code>列の平均(<code>mean</code>)と中央値(<code>median</code>)を求めて表示しています.</p>
<p>6,7行目はもともとのデータで空だった,<code>BMI</code>列を計算し,計算結果を表示しています.</p>
<p>これらの操作の具体的な使い方や意味はこのあと細かく扱いますが,取り敢えず,pandasではこのようにして,データを読み込み,処理することができます.</p>
<h3 data-number="1.3" id="なぜexcelではだめなのか"><span class="header-section-number">1.3</span> なぜExcelではだめなのか</h3>
<p>先ほど行った簡単な表計算であれば,Excelでも簡単に同じことができます. では,なぜややこしいPythonなどを学んでプログラムで同じことをするのでしょうか.</p>
<p>まず,第1にPythonを利用することで</p>
<p><strong>機械学習や高度な検定など,Excelではできない高度な処理が可能</strong>になります.</p>
<p>先ほど行った簡単な集計であればExcelでも可能ですが,後ほど行う機械学習や自然言語処理などの高度な処理はExcelでは実行が困難です. また, データに関してもExcelでは最大で1,048,576行程度のデータしか扱うことができませんが,(この講義では扱いませんが)データサイエンスでは,それを超えた大容量のデータを扱うことがしばしばあります.</p>
<p>第2の理由として,</p>
<p><strong>Excelが複数の連続した複雑な処理には向いていない</strong>ということが挙げられます.</p>
<p>Excelでは,何か作業をしても<strong>過程が記録されず,結果だけが残ります.</strong> また,折角複雑な処理を実行しても,異なるデータなどで同じ処理を行う場合にはゼロから繰り返す必要があり,<strong>処理自体を再利用できません</strong>(VBAやマクロなどはありますが,それらは結局プログラミングをしているので同じです.)</p>
<p>Excelのこのような特性から,Excelによる複雑な処理の実行は,人間の作業に依存する傾向が強く,ミスの原因となります.</p>
<p>このことについて,以下のデータを事例にもう少し具体的に意味を見ていきましょう.</p>
<p><img src="../images/excel-procedure1.png" /></p>
<p>例としてこのデータに対して以下の3つの処理をすることを考えます.</p>
<div class="note">
<pre><code>1. いらない部分を削除する
2. 右側に行和を表す列を足す
3. とある列の値が一定以下のデータを抜き出す</code></pre>
</div>
<p><img src="../images/excel-procedure2.png" /></p>
<p>この場合,EXCELでは最後の抜き出したデータだけが残り,中間の段階の処理も,過程も記録されません.
したがって,</p>
<div class="note">
<ol type="1">
<li>途中で間違っていても気づけない,チェックできない</li>
<li>何をしたのかを他の場所にメモして置かなければ分からない,メモも難しい</li>
<li>別のデータを使う場合同じ処理をもう一度する必要がある</li>
</ol>
</div>
<p>などの問題がよく起こります.</p>
<p>また,削除の作業などは(これくらいなら自動でもできますが)一つ一つ消していく必要があり大きなデータ(数万行とか)では非常に手間がかかります.</p>
<p>Excelはこのように,処理が人間の記憶や,正確さに依存しています. その結果,ミスの原因となっています.</p>
<div class="note">
<p>例えば, こちらの記事(<a href="https://www.teampay.co/blog/biggest-excel-mistakes-of-all-time">The 7 Biggest Excel Mistakes of All Time</a>)では,過去にExcelの操作ミスで起きた大規模なミスの事例が紹介されています.</p>
<ul>
<li>2008年 バークレイズ・キャピタル</li>
</ul>
<p>隠していたセルがPDF板では表示されていたことによる数百万ドルの損失が発生.</p>
<ul>
<li>2012年 ロンドン オリンピック</li>
</ul>
<p>作業員のタイプミスで,10万枚のチケットが払い戻し</p>
<ul>
<li>2012 JPモルガン</li>
</ul>
<p>Excelのコピペミスにより60億ドルの損失</p>
<p>ちなみにこの記事には載っていませんが,2019年に話題になった,厚生労働省の毎月勤労統計における不正問題もExcelのミスが原因の一つです.</p>
</div>
<p>一方プログラムでは,これらの問題が解決可能です.</p>
<p>先程のExcelの作業と同じ例で考えてみましょう.
以下のコードは先程のExcelで行った作業を実行しています.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#データの読み込み</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'sample.csv'</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#いらない部分を削除する</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>df.dropna(axis<span class="op">=</span><span class="st">'index'</span>,how<span class="op">=</span><span class="st">'any'</span>,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#右側に行和を追加する</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'sum'</span>] <span class="op">=</span> df.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#data3が50以下の行を消す</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[df[<span class="st">'data3'</span>]<span class="op">&gt;</span><span class="dv">50</span>]</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#確認</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code></pre></div>
<p>実行結果は当然Excelで行ったものと同じです.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> python <span class="ex">sample.py</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">data1</span>   data2   data3    sum</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="ex">3</span>    86.0      75    67.0  228.0</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="ex">4</span>    66.0      92    90.0  248.0</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="ex">7</span>     6.0      66    93.0  165.0</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="ex">10</span>   27.0      32    52.0  111.0</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="ex">18</span>   27.0      61    91.0  179.0</span></code></pre></div>
<p>しかし, Excelと異なりこのプログラムを実行しても<strong>元データは変わっていない</strong>ため,元の状態にいつでも戻ることが可能です. 更に何を行ったかの<strong>処理がプログラムとして残っている</strong>ため,途中で間違いがないかのチェックや修正が可能です.
(本講義では扱いませんが, 実際にはプログラムでもミスは絶対におきます.そのためテストを実施するのですが,人間の行うチェックリストなどのテストよりもプログラムで行うテストの方が信頼性が高いのも利点です.)</p>
<p>また,
<strong>プログラムがそのまま作業メモ</strong>になっているので,他人に何を行ったかの説明が可能です. 加えて,このプログラムを再利用することで,<strong>異なるデータで同じ作業をする場合に再利用することが可能</strong>です. また,実際の処理はすべてプログラムが自動で行うため<strong>作業の手間がデータの容量にかかわらず一定</strong>です.</p>
<p>確かに,これまでに皆さんが講義で習ってきたような内容であれば,Excelのほうが学習コストが低く手軽に行えます. しかし,今後行うような統計処理やデータサイエンスなど,処理が複雑になればなるほど,プログラムで処理するメリットが大きくなります.</p>


<!-- 前後の章へのナビゲーション -->
<div class="chapter-navigation">
    <nav>
        
            <a class="nav-link prev" href="slds2.html">← Previous Chapter</a>
        
        
            <a class="nav-link next" href="slds5.html">Next Chapter →</a>
        
    </nav>
</div>

    <div style="clear: both"></div>

    <div id="footer">
        Site proudly generated by
        <a href="http://jaspervdj.be/hakyll">Hakyll</a>.
    </div>
</div>


    <!-- GUID -->
    <div style="display: none">ce0f13b2-4a83-4c1c-b2b9-b6d18f4ee6d2</div>




    <!-- JavaScript TOC generator (only runs on lecture pages) -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
      var tocContainer = document.getElementById('lecture-toc');
      if (!tocContainer) return;

      // メインコンテンツから h2, h3, h4 を抽出
      var content = document.querySelector('article') || document.getElementById('content') || document.body;
      var headings = content.querySelectorAll('h2, h3, h4');
      if (headings.length === 0) return;

      // 目次用のUL要素を作成
      var tocList = document.createElement('ul');

      // 章番号カウンタ (h2, h3, h4に対応して配列を用意)
      var chapterNumbers = [0, 0, 0];

      headings.forEach(function(heading) {
        if (heading.closest('li')) return;

        var level;
        switch (heading.tagName.toLowerCase()) {
          case 'h2': level = 0; break;
          case 'h3': level = 1; break;
          case 'h4': level = 2; break;
          default: return;
        }

        chapterNumbers[level]++;
        for (var i = level + 1; i < chapterNumbers.length; i++) {
          chapterNumbers[i] = 0;
        }


        var li = document.createElement('li');
        li.classList.add('toc-level-' + (level + 1));

        var anchor = document.createElement('a');
        anchor.href = '#' + heading.id;
        anchor.textContent =  heading.textContent;

        li.appendChild(anchor);
        tocList.appendChild(li);
      });

      tocContainer.appendChild(tocList);
    });
    </script>
     <script>
  document.addEventListener("DOMContentLoaded", function() {
    // すべての <pre><code> 要素を走査
    const codeBlocks = document.querySelectorAll('pre code');
    codeBlocks.forEach(function(codeBlock) {
      // 親<pre>要素を取得
      const pre = codeBlock.parentNode;

      // <pre> を相対配置にし、子要素を絶対配置できるようにする
      pre.style.position = 'relative';

      // コピーボタンを作成
      const copyButton = document.createElement('button');
      copyButton.textContent = 'Copy';
      // ボタンのデザインはCSSで指定するのが望ましいが、簡易的にスタイルを直接指定する例:
      copyButton.style.position = 'absolute';
      copyButton.style.top = '8px';
      copyButton.style.right = '8px';
      copyButton.style.backgroundColor = '#add8e6'; // 水色
      copyButton.style.color = '#fff';             // 白文字
      copyButton.style.border = 'none';
      copyButton.style.padding = '6px 10px';
      copyButton.style.borderRadius = '4px';
      copyButton.style.cursor = 'pointer';

      // クリックされたらクリップボードにコピー
      copyButton.addEventListener('click', function() {
        const codeText = codeBlock.innerText;
        navigator.clipboard.writeText(codeText).then(function() {
          copyButton.textContent = 'Copied!';
          setTimeout(function() {
            copyButton.textContent = 'Copy';
          }, 2000);
        }, function(err) {
          console.error('Failed to copy: ', err);
        });
      });

      // ボタンを <pre> の子要素として挿入
      pre.appendChild(copyButton);
    });
  });
  </script>
  <script>
    function toggleMenu() {
      var nav = document.getElementById('navigation');
      nav.classList.toggle('open');
    }
  </script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      var mathElements = document.querySelectorAll('.math');
      for (var i = 0; i < mathElements.length; i++) {
        var texText = mathElements[i].firstChild
        if (mathElements[i].tagName == "SPAN") {
            katex.render( texText.data
                        , mathElements[i]
                        , { displayMode: mathElements[i].classList.contains("display")
                          , throwOnError: true
                         }
                        );
          }
      }
    });
  </script>

  </body>
</html>